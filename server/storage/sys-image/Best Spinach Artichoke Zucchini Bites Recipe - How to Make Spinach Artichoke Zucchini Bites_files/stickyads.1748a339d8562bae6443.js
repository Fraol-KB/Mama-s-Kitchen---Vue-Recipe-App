(window.webpackJsonp=window.webpackJsonp||[]).push([["modules/stickyads"],{"25198250de57e9ac2bf1":function(t,e,n){"use strict";n.r(e),n.d(e,"getScrollTop",function(){return g}),n.d(e,"hasLeadVideo",function(){return y}),n.d(e,"getLowerBoundary",function(){return p}),n.d(e,"getUpperBoundary",function(){return v}),n.d(e,"Ad",function(){return k}),n.d(e,"StickyAds",function(){return x});var i=n("8d0684f10c3cea737a13"),o=n("891a19eb7d3552f95f46"),r=n("654adc4d2d3e5dbaee18");function s(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function c(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function a(t,e,n){return e&&l(t.prototype,e),n&&l(t,n),t}var u=[".article-breaker-ad:not(.mobile-breaker-ad)",".listicle-slide-list-ad"].join(","),d=".content-container",f=".content-rail",h="".concat(f,", .right-rail-ad"),g=function(){return window.pageYOffset},y=function(){return null!==document.querySelector(".content-lede-video [data-sticky=true]")},p=function(t){var e,n=t.matches(f)?document.querySelector(u):Object(r.m)(t,u);return e=n?n.getBoundingClientRect().top:(n=document.querySelector(d)).getBoundingClientRect().bottom,(e+=g())-t.getBoundingClientRect().height-window.innerHeight},v=function(t){var e,n=Object(r.p)(t,u);return e=n?n.getBoundingClientRect().bottom+20:(n=document.querySelector(d)).getBoundingClientRect().top,g()+e},k=function(){function e(t){c(this,e),this.el=t,this.storeParent(),this.fixedToTop=!0,this.fixedToBottom=!1}return a(e,[{key:"fix",value:function(){var t=this.el.getBoundingClientRect().left,e=document.body.clientWidth-(this.el.offsetWidth+t),n=["position: fixed","top: ".concat(90,"px"),"right: ".concat(e,"px"),"width: auto"].join(";");this.storeParent(),this.el.style.cssText=n,this.fixedToTop=!1,this.fixedToBottom=!1}},{key:"fixToBottom",value:function(t){var e=t-(g()+this.parent.getBoundingClientRect().top);this.el.style.cssText="position: absolute; top: ".concat(e,"px; right:40px;"),this.fixedToBottom=!0}},{key:"unfix",value:function(){this.el.style.cssText="",this.fixedToTop=!0}},{key:"storeParent",value:function(){this.parent=this.el.offsetParent}}]),e}(),x=function(){function n(t){var e=this;c(this,n),this.ads=[],this.el=t,this.fixed=!1,this.scrollTracking=!1,this.lastScrollY=g(),this.logger=new o.a("StickyAds"),this.registerAds(this.el.querySelectorAll(h)),this.observer=Object(r.r)(this.el,this.handleMutation.bind(this),{childList:!0,subtree:!0}),window.addEventListener("glimmer.sticky",function(){return e.handleStickyVideo()}),window.addEventListener("glimmer.unsticky",function(){return e.handleUnstickyVideo()}),this.startScrollTracking()}return a(n,null,[{key:"setup",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=document.querySelector(t.selector||".content-container");return!e||Modernizr.mobile||Modernizr.tablet||y()?null:new n(e)}}]),a(n,[{key:"handleMutation",value:function(t){var e=s(t.addedNodes).filter(function(t){return t instanceof Element&&t.matches(h)});e.length&&this.registerAds(e)}},{key:"handleScroll",value:function(t){var e=t>this.lastScrollY?"down":"up";if(this.lastScrollY=t,this.fixed){var n=this.fixed.el;if("down"===e){var i=p(n);i<=t+90&&(this.fixed.fixToBottom(i),this.fixed=null)}else t+90<=v(n)&&(this.fixed.unfix(),this.fixed=null)}else this.checkForAdsToFix(e)}},{key:"handleStickyVideo",value:function(){this.stopScrollTracking();for(var t=0,e=this.ads.length;t<e;t+=1)this.ads[t].unfix();this.fixed=null}},{key:"handleUnstickyVideo",value:function(){this.startScrollTracking()}},{key:"startScrollTracking",value:function(){i.a.on("scroll",this.handleScroll.bind(this),"sticky-ads"),this.scrollTracking=!0}},{key:"stopScrollTracking",value:function(){i.a.off("scroll","sticky-ads"),this.scrollTracking=!1}},{key:"checkForAdsToFix",value:function(t){for(var e=0,n=this.ads.length;e<n;e+=1){var i=this.ads[e],o=i.el,r=o.getBoundingClientRect(),s=r.bottom,c=r.top;if(0<s&&c<window.innerHeight){if("down"===t?c<=90&&!i.fixedToBottom&&p(o)>v(o):90<=c&&!i.fixedToTop)return i.fix(),void(this.fixed=i)}}}},{key:"registerAds",value:function(t){var e=this;s(t).forEach(function(t){return e.ads.push(new k(t))}),this.logger.log("regiserted new ads",t,this.ads),this.ads.sort(function(t,e){var n=t.el.getBoundingClientRect().top,i=e.el.getBoundingClientRect().top;return i<n?1:n<i?-1:0})}}]),n}()}}]);
//# sourceMappingURL=stickyads.1748a339d8562bae6443.js.map